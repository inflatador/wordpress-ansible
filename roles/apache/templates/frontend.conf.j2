# Generated by ansible-role-httpd

# VHost for serving site traffic

<VirtualHost *:80>
    ServerName {{ my_pub_ip4 }}
    ServerAlias {{ my_pub_ip6 }}
    ErrorLog {{ apache_log_path }}/magento-frontend-error.log
    CustomLog {{ apache_log_path }}/magento-frontend-access.log combined

    SetEnvIf X-Forwarded-Proto https HTTPS=on

    #comment

    # ProxyPass will default add `X-Forwarded-For`, `X-Forwarded-Host` and `X-Forwarded-Server`
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:6081/
    ProxyPassReverse / http://127.0.0.1:6081/
</VirtualHost>


<VirtualHost *:443>
    ServerName {{ my_pub_ip4 }}
    ServerAlias {{ my_pub_ip6 }}
    ErrorLog {{ apache_log_path }}/magento-frontend-error.log
    CustomLog {{ apache_log_path }}/magento-frontend-access.log combined

    SSLEngine On
    SSLCertificateFile {{ ssl_cert_path }}/magento.crt
    SSLCertificateKeyFile {{ ssl_key_path }}/magento.key

    #comment


    # ProxyPass will default add `X-Forwarded-For`, `X-Forwarded-Host` and `X-Forwarded-Server`
    ProxyPreserveHost On
    RequestHeader set X-Forwarded-Proto https
    RequestHeader set X-Forwarded-Port 443
    ProxyPass / http://127.0.0.1:6081/
    ProxyPassReverse / http://127.0.0.1:6081/
</VirtualHost>